<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>009 GROUP</title>

    <!-- select 2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>

    <link rel="stylesheet" href="css/main.css">

    <!-- /////////////////////////////////////////////////////////////////////////////////////////////// -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script> <!-- JQuery -->
    <!-- /////////////////////////////////////////////////////////////////////////////////////////////// -->


</head>
<body>

<div class="main-body">
    <div class="header-page">
        <div class="header-icon"><img src="images/009_Group_LOGO_gor_new.svg" alt="service icon"
                                      class="header-icon-img"></div>
        <div class="header-consultation"></div>
    </div>

    <div class="page-title">Welcome<br>Please select an appointment date and time</div>

    <div class="main">
        <div class="main-content">
            <div id="calendar">
                <div class="header">
                    <button id="prev">Previous</button>
                    <h2 id="month-year"></h2>
                    <button id="next">Next</button>
                </div>
                <div class="days">
                    <div class="day">Mon</div>
                    <div class="day">Tue</div>
                    <div class="day">Wed</div>
                    <div class="day">Thu</div>
                    <div class="day">Fri</div>
                    <div class="day">Sat</div>
                    <div class="day">Sun</div>
                </div>
                <div id="dates"></div>
            </div>
        </div>

        <!-- Modal Form -->
        <div id="modal" class="modal">
            <div class="modal-content">
                <div class="form appointment-form" id="appointment-form">
                    <div class="title">Record form</div>
                    <div class="input-container ic2">
                        <input id="firstname" class="input" type="text" placeholder=" "/>
                        <div class="cut"></div>
                        <label for="firstname" class="placeholder">First name</label>
                    </div>
                    <div class="input-container ic2">
                        <input id="lastname" class="input" type="text" placeholder=" "/>
                        <div class="cut"></div>
                        <label for="lastname" class="placeholder">Last name</label>
                    </div>
                    <div class="input-container ic2">
                        <input id="timeSlot" class="input" type="text" name="timeSlot" placeholder=" " readonly>
                        <div class="cut"></div>
                        <label for="timeSlot" class="placeholder">Time Slot</label>
                    </div>

                    <div class="input-container ic2">
                        <input id="phone" class="input" type="text" name="phone" placeholder="">
                        <div class="cut"></div>
                        <label for="phone" class="placeholder">Phone Number</label>
                    </div>

                    <div class="input-container ic2">
                        <input id="Comments" class="input" type="text" name="Comments" placeholder=" ">
                        <div class="cut"></div>
                        <label for="Comments" class="placeholder">Comments</label>
                    </div>

                    <div class="toggle-button" id="toggleCarInfo">
                        <div class="toggle-button-header">Car Parameters</div>
                        <div class="toggle-button-icon"><img src="./images/Arrow_Bottom.svg" alt="Arrow_Bottom"></div>
                    </div>

                    <div class="subform hidden" id="car-subform">
                        <div class="input-container ic2">
                            <input id="car-make" class="input" type="text" name="carMake" placeholder=" ">
                            <div class="cut"></div>
                            <label for="car-make" class="placeholder">License plate number</label>
                        </div>
                        <div class="input-container ic2">
                            <select id="brand" class="select2 brand input" name="brand">
                                <option value="" disabled selected hidden></option>
                            </select>
                            <div class="cut"></div>
                            <label for="brand" class="placeholder">Car brand</label>
                        </div>
                        <div class="input-container ic2">
                            <select id="model" class="select2 model input" name="model">
                                <option value="" disabled selected hidden></option>
                            </select>
                            <div class="cut"></div>
                            <label for="model" class="placeholder">Car model</label>
                        </div>
                        <div class="input-container ic2">
                            <input id="mileage" class="input" type="text" name="mileage" placeholder=" ">
                            <div class="cut"></div>
                            <label for="mileage" class="placeholder">Mileage</label>
                        </div>
                        <div class="input-container ic2">
                            <select id="unitOfMeasurement" class="input" name="unitOfMeasurement">
                                <option value="" disabled selected hidden></option>
                                <option value="km">Kilometers (km)</option>
                                <option value="miles">Miles (mi)</option>
                                <option value="liters">Liters (L)</option>
                                <option value="gallons">Gallons (gal)</option>
                            </select>
                            <div class="cut"></div>
                            <label for="unitOfMeasurement" class="placeholder">Unit of measurement</label>
                        </div>
                    </div>


                    <div class="submit-div">
                        <button id="submitForm" class="submit">Submit</button>
                    </div>
                </div>

            </div>
        </div>

    </div>

</div>

<!-- /////////////////////////////////////////////////////////////////////////////////////////////// -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<!-- /////////////////////////////////////////////////////////////////////////////////////////////// -->
<script src="js/error-handling/errors.js"></script> <!-- error handling -->

<script src="js/configs/configs.js"></script> <!-- Get All values and URLs  -->

<script src="js/make-request.js"></script> <!-- function for build Request -->

<script src="js/request-function.js"></script> <!-- function for send Request -->

<script src="js/request-template.js"></script> <!-- Request function -->

<script src="js/main.js"></script> <!-- work code -->
<!-- /////////////////////////////////////////////////////////////////////////////////////////////// -->


<script>
    $(document).ready(async function () {
        initializeCalendar({
            calendarSelector: '#calendar',
            monthYearSelector: '#month-year',
            datesSelector: '#dates',
            prevButtonSelector: '#prev',
            nextButtonSelector: '#next',
        });

        await getBrands({"_type": "brand"});



        // Close modal when clicking outside of the form
        $(document).on('click', function (e) {
            // Перевірка, чи натиснуто на модальне вікно або його елементи
            if (!$(e.target).closest('.modal-content').length &&
                !$(e.target).is('#calendar, #calendar *') &&
                !$(e.target).closest('.select2-container').length) {
                $('#modal').fadeOut();
            }
        });


        $('#brand, #model, #unitOfMeasurement').select2({
            placeholder: "Select an option",
        });


        // submit(record) event
        $('#submitForm').on('click', function (e) {
            e.preventDefault();
            const timeSlot = $('#timeSlot').val();
            const appointmentDate = $('.date.selected').text();
            const monthYearText = $('#month-year').text();

            // Update the page title with the success message
            $('.page-title').html(`Appointment successfully booked for ${appointmentDate} ${monthYearText} at ${timeSlot} <img src="images/successful_icon.svg" alt="successful">`);

            $('#modal').fadeOut();
            $('.main-content').fadeOut();
        });


        // toggle car parameters
        $('#toggleCarInfo').on('click', function () {
            $('#car-subform').slideToggle().css('display', 'flex');
            $('.toggle-button-icon > img').toggleClass('rotate-icon');
        });

        // Event for choosing brand
        $('#brand').on('change', async function () {
            const id = $(this).attr('id');

            const selectObject = {
                "_type": "model",
                "brand_name_inscription": $(this).val()
            };

            // Calling the function to retrieve models, passing the selected brand
            if (id === 'brand') {
                await getModels(selectObject);
            }
        });

    });

</script>

</body>
</html>
